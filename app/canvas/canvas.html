<div class="container-fluid">

  <form>
  <input type="submit" ng-click="runCode()">RUN CODE</input>
  </form>

  <!-- TOOLBOX -->
  <div class="toolbox">
    <span ng-repeat="codeBlock in codeBlocks">
      <div class="codeBlock" ng-drag="true" ng-drag-data="codeBlock" data-allow-transform="true" ng-drag-success="onDragFromToolbox()">
        <span id="variableType">{{codeBlock.type}}</span>
      </div>
    </span>
  </div>

  <!-- CANVAS -->
  <div class="canvasArea" ng-drop="true" ng-drop-success="onDrop($data, $event)">

    <!-- CODE BLOCK NG-REPEAT CONTAINER -->
    <div ng-prevent-drag="true" ng-repeat="codeBlock in droppedCodeBlocks track by $index" ng-drag="true" ng-drag-data="codeBlock" ng-switch="codeBlock.type">

      <!-- VARIABLE CODE BLOCK -->
     <div ng-switch-when="variable" class="codeBlockDropped" ng-model="codeBlock" name="codeBlock" ng-drag-data="codeBlock" ng-drag="isCodeBlockDraggable" ng-drag-success="onDragFromCanvas()">

        <!-- CODE BLOCK NAME -->
        <div id="variableName" ng-click="showNameForm = showNameForm ? false : true; turnOnDrag()">
          {{codeBlock.name}}
        </div>

        <div id="variableValue" ng-click="showValueForm = showValueForm ? false : true; turnOnDrag()">
          {{codeBlock.value}}
        </div>

        <!-- CODEBLOCK NAME FORM -->
        <form ng-if="showNameForm" ng-submit="setVariable(codeBlock, name, val, $event)">
          <input placeholder="Enter name..." ng-model="name" name="name" id="name" type="text" ng-click="turnOffDrag()">
        </form>

        <form ng-if="showValueForm" ng-submit="setVariable(codeBlock, name, val, $event)">
          <input placeholder="Enter value..." ng-model="val" name="val" id="val" type="text" ng-click="turnOffDrag()">
        </form>
      </div>

      <!-- ARRAY CODE BLOCK -->
      <div ng-switch-when="array" ng-drag="true" ng-drop="true" ng-drop-success="codeBlock.push($data)" ng-drag-data="codeBlock" class="codeBlockDropped" ng-drag-success="onDragFromCanvas()">
        <div id="variableName" ng-click="showNameForm = showNameForm ? false : true">
          {{codeBlock.name}}
        </div>

        <div id="variableValue" ng-click="showValueForm = showValueForm ? false : true">
          {{codeBlock.value}}
        </div><div id="popArray" ng-click="codeBlock.pop()">Pop!</div>
      </div>

        <!-- OBJECT CODE BLOCK -->
        <div ng-switch-when="object" ng-drag="isCodeBlockDraggable" ng-drop="isCodeBlockDraggable" ng-drop-success="codeBlock.setValue($data)" ng-model="codeBlock" name="codeBlock"  ng-drag-data="codeBlock" class="codeBlockDropped" ng-drag-success="onDragFromCanvas()">
          <div id="objectName">
            <div>{{codeBlock.name}}</div><div id="addKeyValue" ng-click="addKeyValueForm = addKeyValueForm ? false : true">+</div>
          </div>
          <!-- NG-REPEAT OF KEY-VALUE PAIRS -->
          <div ng-repeat="(key, value) in codeBlock.storage">
            <span id="objectKey" ng-click="showKeyForm = showKeyForm ? false : true; promptKey(codeBlock.storage, this)">{{key}}:</span><span id="objectValue" ng-click="showValueForm = showValueForm ? false : true; promptValue(codeBlock.storage, this)">{{value}}</span>
          </div>
          <form ng-if="showKeyForm" ng-submit="codeBlock.setKey(key)">
            <input placeholder = "Enter key name..." ng-model="key" name="key" id="key" type="text" ng-click="turnOffDrag()">
          </form>
           <form ng-if="showValueForm" ng-submit="codeBlock.setValue(value, true)">
            <input placeholder = "Enter object value.." ng-model="value" name="value" id="value" type="text" ng-click="turnOffDrag()">
          </form>
          <form ng-if="addKeyValueForm" ng-submit="codeBlock.addKeyValue(key, value); turnOnDrag()">
            <input placeholder = "Enter key" ng-model="key" name="key" id="key" type="text" ng-click="turnOffDrag()">
            <input placeholder = "Enter value" ng-model="value" name="value" id="value" type="text" ng-click="turnOffDrag()">
            <input type="submit">
          </form>
        </div>

        <!-- ADD METHOD CODE BLOCK -->
        <div ng-switch-when="add()" ng-drag="isCodeBlockDraggable" ng-drop="isCodeBlockDraggable" ng-drop-success="codeBlock.addParam($data)" ng-model="codeBlock" name="codeBlock"  ng-drag-data="codeBlock" class="codeBlockDropped" ng-drag-success="onDragFromCanvas()">
          <div id="objectName" ng-click="showDefinition = showDefinition ? false : true">{{codeBlock.name}}</div> function (
          {{codeBlock.parameters.join(", ")}}
          )
          <div ng-if="showDefinition">
            <div><pre>{{codeBlock.definition}}</pre></div>
            <span ng-click="codeBlock.execute()">Run function!</span>
          </div>
        </div>

        <!-- SUBTRACT METHOD CODE BLOCK -->
        <div ng-switch-when="subtract()" ng-drag="isCodeBlockDraggable" ng-drop="isCodeBlockDraggable" ng-drop-success="codeBlock.addParam($data)" ng-model="codeBlock" name="codeBlock"  ng-drag-data="codeBlock" class="codeBlockDropped" ng-drag-success="onDragFromCanvas()">
          <div id="objectName" ng-click="showDefinition = showDefinition ? false : true">{{codeBlock.name}}</div> function (
          {{codeBlock.parameters.join(", ")}}
          )
          <div ng-if="showDefinition">
            <div><pre>{{codeBlock.definition}}</pre></div>
            <span ng-click="codeBlock.execute()">Run function!</span>
          </div>
        </div>

      </div>

      <div><img ng-click="emptyCanvas()" ng-drop="true" ng-drop-success="deleteCodeblock($data)"src="../images/trash.png" id="trashbin"></div>

      </div>

    </div>

  </div>

  <!-- COMPILED CODE AREA -->
  <div class="codeArea">
    <pre id="code">{{code}}</pre>
  </div>

</div>